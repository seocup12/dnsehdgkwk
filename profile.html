<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POKE RUN: PROFILE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root { --volt: #ccff00; --bg-main: #000000; --bg-card: #111111; --text-main: #ffffff; --border-color: #262626; }
        body { font-family: sans-serif; background: var(--bg-main); color: var(--text-main); }
    </style>
</head>
<body class="flex justify-center h-screen bg-[var(--bg-main)]">
    <div class="w-full max-w-md h-full relative bg-[var(--bg-main)] flex flex-col">
        <main class="flex-1 overflow-y-auto pb-20">
            <div class="px-4 pt-6 pb-2">
                <div class="flex items-center justify-between mb-4">
                    <div class="relative group cursor-pointer" onclick="document.getElementById('profile-img-input').click()">
                        <div class="w-20 h-20 rounded-full p-[2px] bg-gradient-to-tr from-[var(--volt)] to-purple-500">
                            <img id="my-profile-img" class="w-full h-full rounded-full border-2 border-[var(--bg-main)] object-cover bg-[var(--bg-card)]">
                        </div>
                        <div class="absolute bottom-0 right-0 bg-[var(--volt)] text-black rounded-full p-1 border-2 border-[var(--bg-main)]"><i data-lucide="plus" class="w-3 h-3"></i></div>
                        <input type="file" id="profile-img-input" class="hidden" accept="image/*" onchange="uploadProfileImage(this)">
                    </div>
                    <div class="flex-1 flex justify-around text-[var(--text-main)] ml-4">
                        <div class="flex flex-col items-center"><span class="font-bold text-lg">12</span><span class="text-xs text-gray-500">ê²Œì‹œë¬¼</span></div>
                        <div class="flex flex-col items-center"><span class="font-bold text-lg">128</span><span class="text-xs text-gray-500">íŒ”ë¡œì›Œ</span></div>
                        <div class="flex flex-col items-center"><span class="font-bold text-lg">45</span><span class="text-xs text-gray-500">íŒ”ë¡œì‰</span></div>
                    </div>
                </div>
                <div class="mb-5">
                    <h3 id="my-profile-name" class="font-bold text-sm">Loading...</h3>
                    <p class="text-xs text-gray-500 mt-1">ì˜¤ëŠ˜ë„ ì¦ê²ê²Œ ë‹¬ë¦¬ê¸° ğŸƒâ€â™‚ï¸ğŸ’¨</p>
                </div>
                <div class="flex gap-2 text-sm font-bold">
                    <button class="flex-1 bg-[#262626] py-1.5 rounded-lg border border-[#262626]">í”„ë¡œí•„ í¸ì§‘</button>
                    <button class="flex-1 bg-[#262626] py-1.5 rounded-lg border border-[#262626]">í”„ë¡œí•„ ê³µìœ </button>
                </div>
            </div>
            <div class="grid grid-cols-3 gap-0.5">
                <div class="bg-gray-800 aspect-square"></div>
                <div class="bg-gray-800 aspect-square"></div>
                <div class="bg-gray-800 aspect-square"></div>
            </div>
        </main>

        <nav class="w-full bg-[var(--bg-main)] border-t border-[var(--border-color)] px-2 py-4 flex justify-between items-end pb-8">
            <button onclick="location.href='log.html'" class="flex-1 flex flex-col items-center gap-1 text-[#9ca3af]"><i data-lucide="home" class="w-6 h-6"></i><span class="text-[10px]">í”¼ë“œ</span></button>
            <button onclick="location.href='reels.html'" class="flex-1 flex flex-col items-center gap-1 text-[#9ca3af]"><i data-lucide="clapperboard" class="w-6 h-6"></i><span class="text-[10px]">ë¦´ìŠ¤</span></button>
            <div class="relative w-16 flex justify-center"><button onclick="location.href='upload.html'" class="absolute bottom-2 bg-[var(--volt)] text-black p-3.5 rounded-full border-4 border-black"><i data-lucide="plus" class="w-7 h-7"></i></button></div>
            <button onclick="location.reload()" class="flex-1 flex flex-col items-center gap-1 text-[var(--volt)]"><i data-lucide="user" class="w-6 h-6"></i><span class="text-[10px]">í”„ë¡œí•„</span></button>
            <button onclick="location.href='settings.html'" class="flex-1 flex flex-col items-center gap-1 text-[#9ca3af]"><i data-lucide="settings" class="w-6 h-6"></i><span class="text-[10px]">ì„¤ì •</span></button>
        </nav>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        
        const app = initializeApp({ apiKey: "AIzaSyAbHwLLXIH8rBQ8gNMVqE5SE208aIbfFZ0", authDomain: "pokbattle.firebaseapp.com", projectId: "pokbattle" });
        const auth = getAuth(app);

        onAuthStateChanged(auth, (user) => {
            if(user) {
                document.getElementById('my-profile-name').innerText = user.displayName;
                document.getElementById('my-profile-img').src = user.photoURL || "https://api.dicebear.com/7.x/avataaars/svg?seed=" + user.uid;
            } else {
                location.href = 'home.html';
            }
        });

        window.uploadProfileImage = (input) => {
            if(input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = async (e) => {
                    const newImg = e.target.result;
                    document.getElementById('my-profile-img').src = newImg;
                    await updateProfile(auth.currentUser, { photoURL: newImg });
                };
                reader.readAsDataURL(input.files[0]);
            }
        }
        lucide.createIcons();
    </script>
</body>
</html>